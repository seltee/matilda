#include "matilda.h"
#include "helpers.h"

const unsigned char bitDataHelloWorld[88] = {
    0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    0b01100110, 0b01111110, 0b01100000, 0b01100000, 0b00111100, 0b00000000, 0b01001010, 0b00111100, 0b01111100, 0b01100000, 0b01111100,
    0b01100110, 0b01100000, 0b01100000, 0b01100000, 0b01100110, 0b00000000, 0b01001010, 0b01100110, 0b01100010, 0b01100000, 0b01100010,
    0b01100110, 0b01100000, 0b01100000, 0b01100000, 0b01100110, 0b00000000, 0b01001010, 0b01100110, 0b01111100, 0b01100000, 0b01100010,
    0b01111110, 0b01111110, 0b01100000, 0b01100000, 0b01100110, 0b00000000, 0b01001010, 0b01100110, 0b01110000, 0b01100000, 0b01100010,
    0b01100110, 0b01100000, 0b01100000, 0b01100000, 0b01100110, 0b00000000, 0b01001010, 0b01100110, 0b01101000, 0b01100000, 0b01100010,
    0b01100110, 0b01111110, 0b01111110, 0b01111110, 0b00111100, 0b00000000, 0b00110100, 0b00111100, 0b01100110, 0b01111110, 0b01111100,
    0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000};

const unsigned char byteDataHelloWorld[64 * 11] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 1, 1, 0, 0, 1, 1, 0, 0, 2, 2, 2, 2, 2, 2, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 6, 0, 6, 0, 0, 0, 7, 7, 7, 7, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 3, 3, 3, 0, 0,
    0, 1, 1, 0, 0, 1, 1, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 6, 0, 6, 0, 0, 7, 7, 0, 0, 7, 7, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 3, 0,
    0, 1, 1, 0, 0, 1, 1, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 6, 0, 6, 0, 0, 7, 7, 0, 0, 7, 7, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 3, 0,
    0, 1, 1, 1, 1, 1, 1, 0, 0, 2, 2, 2, 2, 2, 2, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 6, 0, 6, 0, 0, 7, 7, 0, 0, 7, 7, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 3, 0,
    0, 1, 1, 0, 0, 1, 1, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 4, 4, 0, 0, 0, 0, 0, 0, 5, 5, 0, 0, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0, 6, 0, 6, 0, 0, 7, 7, 0, 0, 7, 7, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 3, 3, 0, 0, 0, 3, 0,
    0, 1, 1, 0, 0, 1, 1, 0, 0, 2, 2, 2, 2, 2, 2, 0, 0, 3, 3, 3, 3, 3, 3, 0, 0, 4, 4, 4, 4, 4, 4, 0, 0, 0, 5, 5, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 6, 0, 6, 0, 0, 0, 0, 7, 7, 7, 7, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 0, 2, 2, 2, 2, 2, 2, 0, 0, 3, 3, 3, 3, 3, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

const unsigned short pallete1[8] = {
    0b0000000000000000,
    0b1111100000000000,
    0b0000011111100000,
    0b1111000000011111,
    0b1110011100011100,
    0b0000011111111111,
    0b1111111111100000,
    0b1111100000011111};

const unsigned short pallete2[8] = {
    0b0000000000000000,
    0b1111100000011111,
    0b0000000000011111,
    0b1110011100011100,
    0b0000011111111111,
    0b1111111111100000,
    0b1111100011000000,
    0b1100011111100000};

const unsigned short pallete3[8] = {
    0b0000000000000000,
    0b0011000110011111,
    0b1110011100011100,
    0b0000011111100000,
    0b0110010111111000,
    0b1111111111111110,
    0b1111100000000000,
    0b1111100110011111,
};

const unsigned short pallete4[8] = {
    0b0000000000000000,
    0b0011100111000111,
    0b0101101011001011,
    0b0111101111001111,
    0b1011110111010111,
    0b1100011000011000,
    0b1110011100011100,
    0b1111111111111111,
};

void updateLoop(struct MTLDContext *context)
{
    mtldPrepareNewFrame(context);

    mtldAddSpriteBitMask(context, 0b1110011100011100, bitDataHelloWorld, 11, 11, 8, 4, 4, 0);
    mtldAddSpriteBitMask(context, 0b0000000000011100, bitDataHelloWorld, 11, 11, 8, 4, 4 + 16, 0);
    mtldAddSpriteBitMask(context, 0b0000011100000000, bitDataHelloWorld, 11, 11, 8, 4, 4 + 32, 0);
    mtldAddSpriteBitMask(context, 0b1110000000000000, bitDataHelloWorld, 11, 11, 8, 4, 4 + 48, 0);

    mtldAddSpritePallete(context, pallete1, byteDataHelloWorld, 1, 88, 88, 8, 4, 4 + 64, 0);
    mtldAddSpritePallete(context, pallete2, byteDataHelloWorld, 1, 88, 88, 8, 4, 4 + 80, 0);
    mtldAddSpritePallete(context, pallete3, byteDataHelloWorld, 1, 88, 88, 8, 4, 4 + 96, 0);
    mtldAddSpritePallete(context, pallete4, byteDataHelloWorld, 1, 88, 88, 8, 4, 4 + 112, 0);
}

int main()
{
    unsigned char spriteMem[4096];
    struct MTLDContext context;
    mtldInitDoubleBuffer(&context, spriteMem, 4096);

    makeWindow(GetModuleHandle(nullptr), 1, updateLoop, &context, "Example 1: Hello World");

    return runGameLoop();
}
